<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JiGgY MeNu</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Orbitron:wght@400;700;900&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --bg: #0a0a0f;
    --panel: #0e0e18;
    --border: #1e1e3a;
    --accent: #7b2fff;
    --accent2: #ff2faa;
    --text: #e0e0ff;
    --muted: #6060a0;
    --on: #2fff7b;
    --off: #ff2f2f;
    --hover: #1a1a2e;
    --selected: #15152a;
  }

  html, body {
    width: 100%; height: 100%;
    background: transparent;
    font-family: 'Rajdhani', sans-serif;
    color: var(--text);
    overflow: hidden;
    user-select: none;
  }

  #root {
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 780px;
    height: 520px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 4px;
    box-shadow: 0 0 60px rgba(123,47,255,0.15), 0 0 120px rgba(123,47,255,0.05), inset 0 0 40px rgba(0,0,0,0.8);
    display: none;
    flex-direction: column;
    overflow: hidden;
  }

  #root.visible { display: flex; }

  /* HEADER */
  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 16px;
    height: 44px;
    background: linear-gradient(90deg, #0e0e18, #12122a, #0e0e18);
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }

  .header-title {
    font-family: 'Orbitron', monospace;
    font-size: 13px;
    font-weight: 900;
    letter-spacing: 4px;
    text-transform: uppercase;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .header-controls {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .header-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
  }

  .dot-red { background: #ff5f57; }
  .dot-yellow { background: #febc2e; }
  .dot-green { background: #28c840; }

  /* TAB BAR */
  .tabs {
    display: flex;
    align-items: stretch;
    height: 36px;
    background: var(--panel);
    border-bottom: 1px solid var(--border);
    overflow-x: auto;
    flex-shrink: 0;
  }

  .tabs::-webkit-scrollbar { height: 2px; }
  .tabs::-webkit-scrollbar-track { background: transparent; }
  .tabs::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 2px; }

  .tab {
    display: flex;
    align-items: center;
    padding: 0 16px;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--muted);
    cursor: default;
    white-space: nowrap;
    border-right: 1px solid var(--border);
    transition: all 0.15s;
    position: relative;
    min-width: fit-content;
  }

  .tab.active {
    color: var(--text);
    background: var(--bg);
  }

  .tab.active::after {
    content: '';
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
  }

  /* BODY */
  .body {
    display: flex;
    flex: 1;
    overflow: hidden;
  }

  /* SIDEBAR */
  .sidebar {
    width: 220px;
    border-right: 1px solid var(--border);
    background: var(--panel);
    overflow-y: auto;
    flex-shrink: 0;
    display: none;
  }

  .sidebar.visible { display: block; }

  .sidebar::-webkit-scrollbar { width: 3px; }
  .sidebar::-webkit-scrollbar-track { background: transparent; }
  .sidebar::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 2px; }

  /* CONTENT */
  .content {
    flex: 1;
    overflow-y: auto;
    padding: 8px;
  }

  .content::-webkit-scrollbar { width: 3px; }
  .content::-webkit-scrollbar-track { background: transparent; }
  .content::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 2px; }

  /* ITEMS */
  .item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    margin-bottom: 2px;
    border-radius: 3px;
    font-size: 13px;
    font-weight: 500;
    letter-spacing: 0.5px;
    cursor: default;
    transition: all 0.1s;
    border: 1px solid transparent;
    min-height: 36px;
  }

  .item.selected {
    background: var(--selected);
    border-color: var(--accent);
    color: #fff;
  }

  .item.selected::before {
    content: '▸';
    color: var(--accent);
    margin-right: 8px;
    font-size: 10px;
  }

  .item:not(.selected)::before {
    content: '▸';
    color: transparent;
    margin-right: 8px;
    font-size: 10px;
  }

  .item-label { flex: 1; }

  .item-state {
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 1px;
    padding: 2px 7px;
    border-radius: 2px;
  }

  .item-state.on { background: rgba(47,255,123,0.15); color: var(--on); border: 1px solid rgba(47,255,123,0.3); }
  .item-state.off { background: rgba(255,47,47,0.15); color: var(--off); border: 1px solid rgba(255,47,47,0.3); }

  .item.label-type {
    color: var(--muted);
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 12px 12px 4px;
    cursor: default;
    border-color: transparent;
  }

  .item.label-type::before { display: none; }

  /* INPUT */
  .item.input-type {
    flex-direction: column;
    align-items: stretch;
    gap: 4px;
    padding: 8px 12px;
  }

  .item.input-type .input-label {
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  .item.input-type .input-value {
    font-size: 13px;
    color: var(--text);
    min-height: 20px;
    border-bottom: 1px solid var(--border);
    padding-bottom: 2px;
  }

  .item.input-type.selected .input-value {
    border-color: var(--accent);
  }

  .item.input-type .input-value.typing {
    border-color: var(--accent2);
  }

  .cursor {
    display: inline-block;
    width: 2px;
    height: 14px;
    background: var(--accent2);
    vertical-align: middle;
    margin-left: 1px;
    animation: blink 0.7s infinite;
  }

  @keyframes blink { 0%,50% { opacity: 1; } 51%,100% { opacity: 0; } }

  /* GRID */
  .grid-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px;
    padding: 4px;
  }

  .grid-item {
    padding: 10px 12px;
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 3px;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.5px;
    cursor: default;
    transition: all 0.1s;
    text-align: center;
    min-height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .grid-item.selected {
    background: var(--selected);
    border-color: var(--accent);
    color: #fff;
    box-shadow: 0 0 10px rgba(123,47,255,0.2);
  }

  /* PLAYER OPTIONS */
  .player-options {
    background: var(--selected);
    border: 1px solid var(--accent);
    border-radius: 3px;
    margin-top: 2px;
    overflow: hidden;
  }

  .player-option {
    padding: 7px 24px;
    font-size: 12px;
    color: var(--muted);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .player-option:last-child { border-bottom: none; }

  .player-option.selected {
    color: var(--text);
    background: rgba(123,47,255,0.1);
  }

  .player-option.selected::before {
    content: '▸';
    color: var(--accent);
    font-size: 9px;
  }

  .player-option:not(.selected)::before {
    content: '▸';
    color: transparent;
    font-size: 9px;
  }

  /* STATUS BAR */
  .statusbar {
    height: 26px;
    background: var(--panel);
    border-top: 1px solid var(--border);
    display: flex;
    align-items: center;
    padding: 0 16px;
    gap: 16px;
    flex-shrink: 0;
  }

  .status-item {
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 10px;
    letter-spacing: 1px;
    color: var(--muted);
  }

  .status-key {
    background: rgba(255,255,255,0.06);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 1px 5px;
    font-family: 'Orbitron', monospace;
    font-size: 8px;
    color: var(--accent);
  }

  .tab-header {
    padding: 10px 12px 6px;
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--accent);
    border-bottom: 1px solid var(--border);
    margin-bottom: 6px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .tab-header::before {
    content: '';
    width: 3px;
    height: 12px;
    background: linear-gradient(180deg, var(--accent), var(--accent2));
    border-radius: 2px;
  }

  /* SCANLINE OVERLAY */
  .scanlines {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,0,0,0.03) 2px,
      rgba(0,0,0,0.03) 4px
    );
    pointer-events: none;
    z-index: 100;
  }

  /* CORNER ACCENTS */
  .corner {
    position: absolute;
    width: 12px;
    height: 12px;
    border-color: var(--accent);
    border-style: solid;
    z-index: 101;
  }

  .corner.tl { top: 0; left: 0; border-width: 2px 0 0 2px; }
  .corner.tr { top: 0; right: 0; border-width: 2px 2px 0 0; }
  .corner.bl { bottom: 0; left: 0; border-width: 0 0 2px 2px; }
  .corner.br { bottom: 0; right: 0; border-width: 0 2px 2px 0; }

  .typing-indicator {
    font-size: 10px;
    color: var(--accent2);
    letter-spacing: 1px;
    animation: pulse 1s infinite;
  }

  @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.4; } }
</style>
</head>
<body>
<div id="root">
  <div class="scanlines"></div>
  <div class="corner tl"></div>
  <div class="corner tr"></div>
  <div class="corner bl"></div>
  <div class="corner br"></div>

  <div class="header">
    <div class="header-title">JiGgY MeNu</div>
    <div class="header-controls">
      <div class="header-dot dot-red"></div>
      <div class="header-dot dot-yellow"></div>
      <div class="header-dot dot-green"></div>
    </div>
  </div>

  <div class="tabs" id="tabs"></div>

  <div class="body">
    <div class="content" id="content"></div>
  </div>

  <div class="statusbar">
    <div class="status-item"><span class="status-key">↑↓</span> navigate</div>
    <div class="status-item"><span class="status-key">←→</span> tabs</div>
    <div class="status-item"><span class="status-key">ENTER</span> select</div>
    <div class="status-item"><span class="status-key">ESC</span> back</div>
    <div class="status-item"><span class="status-key">DEL</span> close</div>
    <div id="typing-status" class="typing-indicator" style="display:none;">● TYPING</div>
  </div>
</div>

<script>
  let state = null;

  const playerOptionLabels = [
    "Teleport To", "Bring To Me", "Give Weapons",
    "Heal Player", "Kill Player", "Freeze Player",
    "Spectate", "Explode", "Kick", "Ban"
  ];

  function renderTabs(tabs, activeTab) {
    const container = document.getElementById('tabs');
    container.innerHTML = '';
    tabs.forEach((tab, i) => {
      const el = document.createElement('div');
      el.className = 'tab' + (i === activeTab ? ' active' : '');
      el.textContent = tab.title;
      container.appendChild(el);
    });
  }

  function renderContent(state) {
    const container = document.getElementById('content');
    container.innerHTML = '';

    const tab = state.tabs[state.activeTab];
    if (!tab) return;

    const header = document.createElement('div');
    header.className = 'tab-header';
    header.textContent = tab.header || tab.title;
    container.appendChild(header);

    if (!state.isContentPanelOpen) {
      const hint = document.createElement('div');
      hint.className = 'item label-type';
      hint.textContent = 'Press ENTER to open panel';
      container.appendChild(hint);
      return;
    }

    const items = tab.items || [];

    if (tab.type === 'grid') {
      const grid = document.createElement('div');
      grid.className = 'grid-container';
      items.forEach((item, i) => {
        const el = document.createElement('div');
        el.className = 'grid-item' + (i === state.selection.index ? ' selected' : '');
        el.textContent = item.label || '';
        grid.appendChild(el);
      });
      container.appendChild(grid);
      return;
    }

    items.forEach((item, i) => {
      const isSelected = i === state.selection.index;

      if (item.type === 'label') {
        const el = document.createElement('div');
        el.className = 'item label-type';
        el.textContent = item.label || '';
        container.appendChild(el);
        return;
      }

      if (item.type === 'input') {
        const el = document.createElement('div');
        el.className = 'item input-type' + (isSelected ? ' selected' : '');
        const labelEl = document.createElement('div');
        labelEl.className = 'input-label';
        labelEl.textContent = item.label || '';
        const valueEl = document.createElement('div');
        valueEl.className = 'input-value' + (state.isTyping && isSelected ? ' typing' : '');
        const val = item.value || '';
        if (state.isTyping && isSelected) {
          valueEl.textContent = val || (item.placeholder || '');
          if (!val) valueEl.style.color = 'var(--muted)';
          const cur = document.createElement('span');
          cur.className = 'cursor';
          valueEl.appendChild(cur);
        } else {
          valueEl.textContent = val || item.placeholder || '';
          if (!val) valueEl.style.color = 'var(--muted)';
        }
        el.appendChild(labelEl);
        el.appendChild(valueEl);
        container.appendChild(el);
        return;
      }

      // button or list item
      const el = document.createElement('div');
      el.className = 'item' + (isSelected ? ' selected' : '');

      const labelEl = document.createElement('span');
      labelEl.className = 'item-label';

      // Player list
      if (tab.key === 'players' && item.playerId !== undefined) {
        labelEl.textContent = item.label || '';
        el.appendChild(labelEl);
        container.appendChild(el);

        if (item.showOptions) {
          const opts = document.createElement('div');
          opts.className = 'player-options';
          playerOptionLabels.forEach((opt, oi) => {
            const oel = document.createElement('div');
            oel.className = 'player-option' + (oi === item.selectedOption ? ' selected' : '');
            oel.textContent = opt;
            opts.appendChild(oel);
          });
          container.appendChild(opts);
        }
        return;
      }

      // Resource list
      if (tab.key === 'resources' && item.state) {
        labelEl.textContent = item.label || '';
        el.appendChild(labelEl);
        const stateEl = document.createElement('span');
        stateEl.className = 'item-state ' + (item.state === 'started' ? 'on' : 'off');
        stateEl.textContent = item.state === 'started' ? 'ON' : 'OFF';
        el.appendChild(stateEl);
        container.appendChild(el);
        return;
      }

      labelEl.textContent = item.label || '';
      el.appendChild(labelEl);

      if (item.state !== undefined) {
        const stateEl = document.createElement('span');
        stateEl.className = 'item-state ' + (item.state === 'on' ? 'on' : 'off');
        stateEl.textContent = item.state === 'on' ? 'ON' : 'OFF';
        el.appendChild(stateEl);
      }

      container.appendChild(el);
    });
  }

  function render(newState) {
    state = newState;
    const root = document.getElementById('root');

    if (!state) { root.classList.remove('visible'); return; }

    root.classList.add('visible');
    renderTabs(state.tabs || [], state.activeTab || 0);
    renderContent(state);

    const typingStatus = document.getElementById('typing-status');
    if (typingStatus) typingStatus.style.display = state.isTyping ? 'block' : 'none';

    // Scroll selected item into view
    const selected = document.querySelector('.item.selected, .grid-item.selected');
    if (selected) selected.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
  }

  window.addEventListener('message', function(e) {
    try {
      const msg = typeof e.data === 'string' ? JSON.parse(e.data) : e.data;
      if (msg.action === 'update') render(msg.data);
      else if (msg.action === 'show') render(msg.data);
      else if (msg.action === 'hide') {
        document.getElementById('root').classList.remove('visible');
      }
    } catch(err) {}
  });
</script>
</body>
</html>
